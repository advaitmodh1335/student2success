<!-- AI disclosure 
  Some Part of this code were generated by Chat GPT -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Student · Documents</title>
  <link rel="stylesheet" href="../assets/css/base.css">
  <link rel="stylesheet" href="../assets/css/layout.css">
  <link rel="stylesheet" href="../assets/css/components.css">
  <style>
    .docs-wrap { max-width: 1100px; margin: 0 auto; }

    .docs-table { table-layout: fixed; width: 100%; }
    .docs-table col:nth-child(1) { width: 34%; }
    .docs-table col:nth-child(2) { width: 18%; }
    .docs-table col:nth-child(3) { width: 18%; }
    .docs-table col:nth-child(4) { width: 10%; }
    .docs-table col:nth-child(5) { width: 20%; }
    .docs-table th, .docs-table td { vertical-align: middle; padding-top:.6rem; padding-bottom:.6rem; }
    .docs-table td.num, .docs-table th.num { text-align: right; }
    .docs-table td:last-child, .docs-table th:last-child { min-width: 240px; }

    .actions-group{
      display:grid; grid-template-columns: 1fr 1fr; gap:16px; align-items:center; justify-items:stretch; min-width:0;
    }
    .pill{
      display:flex; align-items:center; justify-content:center;
      width:100%; padding:.22rem .5rem; border-radius:999px; font-size:.82rem; line-height:1.1;
      border:1px solid #d7deea; background:#fff; color:var(--ink); cursor:pointer; text-decoration:none; white-space:nowrap;
    }
    .pill.neutral:hover{background:#f6f8fc;border-color:#c8d2e6}
    .pill.success{border-color:#bfe6cf;background:#effaf3;color:#256d3d}
    .pill.success:hover{background:#e6f6ec;border-color:#a9dfc0}
    .pill.danger{border-color:#f2c7c7;background:#fff6f6;color:#b3261e}
    .pill.danger:hover{background:#ffecec;border-color:#efb2b2}

    /* Download pill → blue shade (documents.html only) */
    .actions-group a.pill[download]{
      border-color:#c6d8ff;
      background:#eaf1ff;
      color:#23407a;
    }
    .actions-group a.pill[download]:hover{
      background:#dfe9ff;
      border-color:#b9ceff;
    }
    .actions-group a.pill[download]:focus{
      outline:2px solid rgba(59,107,231,.28);
      outline-offset:2px;
    }

    @media (max-width: 900px){
      .docs-table col:nth-child(1){ width: 42%; }
      .docs-table col:nth-child(2){ width: 20%; }
      .docs-table col:nth-child(3){ width: 20%; }
      .docs-table col:nth-child(4){ width: 8%; }
      .docs-table col:nth-child(5){ width: 10%; }
      .docs-table td:last-child, .docs-table th:last-child { min-width: 180px; }
      .actions-group{ grid-template-columns: 1fr; }
    }

    html,body{height:100%}
    body{min-height:100vh;display:flex;flex-direction:column}
    .topbar{width:100%;display:flex;justify-content:space-between;align-items:center;padding:16px 24px;border-bottom:1px solid var(--line)}
    .brand{font-weight:700;text-decoration:none;color:var(--ink)}
    .brand:hover{text-decoration:underline}
    .logout{color:var(--ink);text-decoration:none;border:1px solid var(--line);padding:6px 10px;border-radius:10px}
    .logout:hover{background:#fff}

    /* --- NEW: centered primary nav --- */
    .primary-nav{
      flex:1 1 auto;
      display:flex;
      justify-content:center;
      align-items:center;
      gap:8px;
      min-width:0;
    }
    .navlink{
      display:inline-flex;align-items:center;justify-content:center;gap:6px;
      padding:.45rem .8rem;
      border:1px solid var(--line);
      border-radius:10px;
      background:#fff;
      color:var(--ink);
      text-decoration:none;
      white-space:nowrap;
    }
    .navlink:hover{background:#f6f8fc;border-color:#c8d2e6}
    .navlink[aria-current="page"], .navlink.active{
      background:#eaf1ff;border-color:#c6d8ff;color:#23407a
    }
    .navlink svg{width:18px;height:18px;stroke:currentColor;stroke-width:1.8;fill:none}
    /* --- end nav styles --- */

    .back-strip{width:100%;padding:16px 24px 0;display:flex;justify-content:flex-start}
    .backbtn{display:inline-flex;align-items:center;gap:8px;background:#fff;color:var(--ink);border:1px solid var(--line);border-radius:10px;padding:.45rem .8rem;text-decoration:none;cursor:pointer}
    .backbtn:hover{background:#f6f8fc;border-color:#c8d2e6}
    .backbtn svg{width:18px;height:18px;stroke:currentColor}
    .page-header{max-width:1100px;margin:0 auto;padding:12px 24px 24px}
    .page-header h1{margin:0;text-align:center}
    main{flex:1}

    /* Modals */
    .backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(17,24,39,.45);z-index:300}
    .backdrop.show{display:flex}
    .modal{width:min(560px,94vw);background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 24px 60px rgba(2,8,23,.28)}
    .modal header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--line)}
    .modal .body{padding:16px}
    .modal .footer{padding:14px 16px;border-top:1px solid var(--line);display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap}
    .modal .close-x{background:transparent;border:0;font-size:1.4rem;color:var(--muted);cursor:pointer;line-height:1}

    .row{display:flex;align-items:center;gap:10px}
    .check{width:48px;height:48px;border-radius:999px;background:rgba(34,197,94,.12);border:1px solid #bfe6cf;color:#16a34a;display:grid;place-items:center;font-weight:700}
    .btn.danger{background:#dc2626;border-color:#dc2626;color:#fff}
    .btn.danger:hover{background:#b91c1c;border-color:#b91c1c}

    .inline-suffix{display:inline-block;margin-left:6px;color:var(--muted)}
    .error{color:#b3261e;font-size:.9rem;margin-top:6px;display:none}
    .error.show{display:block}

    /* small helper inside upload modal */
    .file-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .file-name{font-size:.9rem;color:var(--muted)}
  </style>
</head>

<body>
  <div class="topbar">
    <a class="brand" href="../index.html">Student2Success</a>

    <!-- NEW: centered nav with requested options -->
    <nav class="primary-nav" aria-label="Primary">
      <!-- Dashboard -->
      <a class="navlink" href="dashboard.html">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <rect x="3" y="3" width="8" height="8" rx="1"></rect>
          <rect x="13" y="3" width="8" height="8" rx="1"></rect>
          <rect x="3" y="13" width="8" height="8" rx="1"></rect>
          <rect x="13" y="13" width="8" height="8" rx="1"></rect>
        </svg>
        <span>Dashboard</span>
      </a>

      <!-- Jobs (distinct magnifier icon) -->
      <a class="navlink" href="jobs.html">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <circle cx="11" cy="11" r="6"></circle>
          <path d="M21 21l-4.3-4.3"></path>
        </svg>
        <span>Jobs</span>
      </a>

      <!-- Saved Jobs -->
      <a class="navlink" href="saved-jobs.html">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M6 3h12a1 1 0 0 1 1 1v16l-7-4-7 4V4a1 1 0 0 1 1-1z"></path>
        </svg>
        <span>Saved Jobs</span>
      </a>

      <!-- Applications -->
      <a class="navlink" href="applications.html">
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <rect x="3" y="8" width="18" height="11" rx="2"></rect>
          <rect x="8" y="4" width="8" height="4" rx="1"></rect>
          <path d="M3 12h18"></path>
        </svg>
        <span>Applications</span>
      </a>
    </nav>

    <a href="../index.html" class="logout">Logout</a>
  </div>

  <div class="back-strip">
    <button class="backbtn" type="button" onclick="(window.location.href='dashboard.html')">
      <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <span>Back</span>
    </button>
  </div>

  <header class="page-header">
    <h1>Document Storage</h1>
  </header>

  <main class="docs-wrap grid cols-2">
    <!-- Upload launcher -->
    <section class="card" aria-labelledby="uploadTitle">
      <h3 id="uploadTitle">Upload New Document</h3>
      <p class="meta" style="margin-top:0">Use the button below to upload. A pop-up will collect details.</p>
      <p class="mt-16"><button id="openUpload" class="btn" type="button">New Upload</button></p>
    </section>

    <!-- Manage card -->
    <section class="card" aria-labelledby="manageTitle">
      <h3 id="manageTitle">Manage Documents</h3>
      <table class="table docs-table" id="docsTable">
        <colgroup><col><col><col><col><col></colgroup>
        <thead>
          <tr>
            <th>Name</th>
            <th>Type</th>
            <th>Uploaded</th>
            <th class="num">Size</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="docsTbody">
          <tr>
            <td>Resume.pdf</td>
            <td>Resume</td>
            <td>2025-01-15</td>
            <td class="num">24 KB</td>
            <td>
              <div class="actions-group">
                <button type="button" class="pill neutral" data-action="rename">Rename</button>
                <button type="button" class="pill success" data-action="default">Set Default</button>
                <a class="pill neutral" href="Resume.pdf" download>Download</a>
                <button type="button" class="pill danger" data-action="delete">Delete</button>
              </div>
            </td>
          </tr>
          <tr>
            <td>CoverLetter.pdf</td>
            <td>Cover Letter</td>
            <td>2025-02-10</td>
            <td class="num">18 KB</td>
            <td>
              <div class="actions-group">
                <button type="button" class="pill neutral" data-action="rename">Rename</button>
                <button type="button" class="pill success" data-action="default">Set Default</button>
                <a class="pill neutral" href="CoverLetter.pdf" download>Download</a>
                <button type="button" class="pill danger" data-action="delete">Delete</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </main>

  <footer class="footer">Student2Success</footer>

  <!-- Upload modal (separate page) -->
  <div id="uploadModal" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="uploadModalTitle">
    <div class="modal" role="document">
      <header>
        <h2 id="uploadModalTitle">Upload Document</h2>
        <button class="close-x" type="button" aria-label="Close" data-close>×</button>
      </header>
      <div class="body">
        <label class="label" for="um_type">Document Type</label>
        <select id="um_type" class="input">
          <option>Resume</option>
          <option>Cover Letter</option>
          <option>Transcript</option>
          <option>Other</option>
        </select>

        <label class="label" for="um_file" style="margin-top:10px">Choose File</label>
        <div class="file-row">
          <input id="um_file" type="file" class="input" accept=".pdf,.doc,.docx,.txt,.png,.jpg,.jpeg" style="max-width:320px">
          <button id="um_browse" class="pill neutral" type="button" aria-controls="um_file">Browse files…</button>
          <span id="um_filename" class="file-name"></span>
        </div>

        <label class="label" for="um_name" style="margin-top:10px">Name</label>
        <input id="um_name" class="input" placeholder="e.g., Resume v2">

        <div id="uploadError" class="error">Please choose a file before uploading.</div>
      </div>
      <div class="footer">
        <button class="btn secondary" type="button" data-close>Cancel</button>
        <button id="um_submit" class="btn" type="button">Upload</button>
      </div>
    </div>
  </div>

  <!-- Upload confirmation modal -->
  <div id="confirmModal" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <div class="modal" role="document">
      <header>
        <h2 id="confirmTitle">Upload Complete</h2>
        <button class="close-x" type="button" aria-label="Close" data-close>×</button>
      </header>
      <div class="body">
        <div class="row">
          <div class="check">✓</div>
          <div>
            <div><strong id="confName">Document</strong> was uploaded.</div>
            <div class="meta" id="confMeta">Type • Size • Date</div>
          </div>
        </div>
      </div>
      <div class="footer">
        <button class="btn" type="button" data-close>Done</button>
      </div>
    </div>
  </div>

  <!-- Delete confirmation modal -->
  <div id="deleteModal" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="deleteTitle">
    <div class="modal" role="document">
      <header>
        <h2 id="deleteTitle">Delete document?</h2>
        <button class="close-x" type="button" aria-label="Close" data-close>×</button>
      </header>
      <div class="body">
        <p id="deleteMsg">This action cannot be undone.</p>
      </div>
      <div class="footer">
        <button class="btn secondary" type="button" data-close>Cancel</button>
        <button id="confirmDelete" class="btn danger" type="button">Delete</button>
      </div>
    </div>
  </div>

  <!-- Rename modal -->
  <div id="renameModal" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="renameTitle">
    <div class="modal" role="document">
      <header>
        <h2 id="renameTitle">Rename Document</h2>
        <button class="close-x" type="button" aria-label="Close" data-close>×</button>
      </header>
      <div class="body">
        <label class="label" for="renameInput">New name</label>
        <div>
          <input id="renameInput" class="input" aria-describedby="renameHint">
          <span id="renameExt" class="inline-suffix"></span>
        </div>
        <div id="renameError" class="error">Please enter a valid name (no / \ : * ? " &lt; &gt; |).</div>
        <div id="renameHint" class="meta" style="margin-top:6px">The file extension is preserved.</div>
      </div>
      <div class="footer">
        <button class="btn secondary" type="button" data-close>Cancel</button>
        <button id="renameSave" class="btn" type="button">Save</button>
      </div>
    </div>
  </div>

  <script>
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));
    const bytesToSize = (b) => { if (!b && b !== 0) return ""; const u=["B","KB","MB","GB"]; let i=0,v=b; while(v>=1024&&i<u.length-1){v/=1024;i++;} return `${Math.round(v*10)/10} ${u[i]}`; };
    const todayISO = () => new Date().toISOString().slice(0,10);
    const splitName = (name) => { const i=name.lastIndexOf("."); return i>0?{base:name.slice(0,i),ext:name.slice(i)}:{base:name,ext:""}; };
    const isValidBase = (s) => s && !/[\\/:*?"<>|]/.test(s);

    const tbody = $("#docsTbody");
    const confirmModal = $("#confirmModal");
    const confName = $("#confName");
    const confMeta = $("#confMeta");

    const deleteModal = $("#deleteModal");
    const deleteMsg = $("#deleteMsg");
    const confirmDeleteBtn = $("#confirmDelete");

    const renameModal = $("#renameModal");
    const renameInput = $("#renameInput");
    const renameExt = $("#renameExt");
    const renameSave = $("#renameSave");
    const renameErr = $("#renameError");

    const uploadModal = $("#uploadModal");
    const openUpload = $("#openUpload");
    const umType = $("#um_type");
    const umFile = $("#um_file");
    const umBrowse = $("#um_browse");
    const umName = $("#um_name");
    const umSubmit = $("#um_submit");
    const umErr = $("#uploadError");
    const umFilename = $("#um_filename");

    let lastFocus = null;
    let pendingDeleteRow = null;
    let pendingRenameRow = null;
    let pendingRenameExt = "";
    let objectURLRegistry = new Map(); // <tr, blobURL>

    function openModal(el){
      lastFocus = document.activeElement;
      el.classList.add("show");
      const first = el.querySelector('button,[href],input,[tabindex]:not([tabindex="-1"])');
      if (first) first.focus();
    }
    function closeModal(el){
      el.classList.remove("show");
      try{ lastFocus && lastFocus.focus(); }catch(_){}
    }
    [confirmModal, deleteModal, renameModal, uploadModal].forEach(m=>{
      m.addEventListener("click", (e)=>{
        if (e.target.hasAttribute("data-close") || e.target === m){
          closeModal(m);
          if (m===deleteModal) pendingDeleteRow=null;
          if (m===renameModal) { pendingRenameRow=null; renameErr.classList.remove("show"); }
          if (m===uploadModal) { umErr.classList.remove("show"); resetUploadModal(); }
        }
      });
    });
    window.addEventListener("keydown",(e)=>{
      if (e.key==="Escape"){
        [confirmModal, deleteModal, renameModal, uploadModal].forEach(m=> m.classList.contains("show") && closeModal(m));
        pendingDeleteRow=null; pendingRenameRow=null; renameErr.classList.remove("show"); umErr.classList.remove("show");
      }
    });

    // --- Upload modal behavior ---
    openUpload.addEventListener("click", ()=>{
      resetUploadModal();
      openModal(uploadModal);
    });
    function resetUploadModal(){
      umType.value = "Resume";
      umFile.value = "";
      umName.value = "";
      umFilename.textContent = "";
    }
    umBrowse.addEventListener("click", ()=> umFile.click()); // opens the native file picker

    umFile.addEventListener("change", ()=>{
      const f = umFile.files && umFile.files[0];
      umFilename.textContent = f ? f.name : "";
      if (f && !umName.value.trim()) umName.value = f.name;
    });

    umSubmit.addEventListener("click", ()=>{
      const f = umFile.files && umFile.files[0];
      if (!f){
        umErr.textContent = "Please choose a file before uploading.";
        umErr.classList.add("show");
        return;
      }
      umErr.classList.remove("show");

      const docName = (umName.value.trim() || f.name).replace(/\s+/g," ");
      const docType = umType.value;
      const sizeStr = bytesToSize(f.size);
      const dateStr = todayISO();

      const tr = document.createElement("tr");

      const tdName = document.createElement("td"); tdName.textContent = docName;
      const tdType = document.createElement("td"); tdType.textContent = docType;
      const tdDate = document.createElement("td"); tdDate.textContent = dateStr;
      const tdSize = document.createElement("td"); tdSize.className="num"; tdSize.textContent = sizeStr;

      const tdActions = document.createElement("td");
      const g = document.createElement("div"); g.className="actions-group";

      const bRen = document.createElement("button"); bRen.type="button"; bRen.className="pill neutral"; bRen.dataset.action="rename"; bRen.textContent="Rename";
      const bDef = document.createElement("button"); bDef.type="button"; bDef.className="pill success"; bDef.dataset.action="default"; bDef.textContent="Set Default";
      const aDl = document.createElement("a"); aDl.className="pill neutral"; aDl.textContent="Download"; aDl.download=docName;
      const url = URL.createObjectURL(f); aDl.href=url; objectURLRegistry.set(tr,url);
      const bDel = document.createElement("button"); bDel.type="button"; bDel.className="pill danger"; bDel.dataset.action="delete"; bDel.textContent="Delete";

      g.append(bRen,bDef,aDl,bDel); tdActions.appendChild(g);
      tr.append(tdName,tdType,tdDate,tdSize,tdActions);
      tbody.prepend(tr);

      // confirmation
      confName.textContent = docName;
      confMeta.textContent = `${docType} • ${sizeStr} • ${dateStr}`;

      closeModal(uploadModal);
      openModal(confirmModal);
      resetUploadModal();
    });

    // --- Table actions: rename/default/delete ---
    tbody.addEventListener("click",(e)=>{
      const btn = e.target.closest("[data-action]");
      if (!btn) return;
      const tr = btn.closest("tr");
      const nameCell = tr.children[0];
      const action = btn.dataset.action;

      if (action==="rename"){
        const current = nameCell.textContent.trim();
        const {base,ext} = splitName(current);
        pendingRenameRow = tr; pendingRenameExt = ext;
        renameInput.value = base; renameExt.textContent = ext; renameErr.classList.remove("show");
        openModal(renameModal); renameInput.select();
      }else if(action==="default"){
        $$("#docsTbody tr").forEach(row=>{
          row.classList.remove("is-default");
          const b = row.querySelector('[data-action="default"]'); if (b) b.textContent="Set Default";
        });
        tr.classList.add("is-default"); btn.textContent="Default ✓";
      }else if(action==="delete"){
        pendingDeleteRow = tr;
        deleteMsg.textContent = `Delete “${nameCell.textContent.trim()}”? This action cannot be undone.`;
        openModal(deleteModal);
      }
    });

    confirmDeleteBtn.addEventListener("click", ()=>{
      if (!pendingDeleteRow) return;
      const url = objectURLRegistry.get(pendingDeleteRow);
      if (url){ URL.revokeObjectURL(url); objectURLRegistry.delete(pendingDeleteRow); }
      pendingDeleteRow.remove(); pendingDeleteRow=null; closeModal(deleteModal);
    });

    function applyRename(){
      if (!pendingRenameRow) return;
      const base = renameInput.value.trim();
      if (!isValidBase(base)){ renameErr.classList.add("show"); renameInput.focus(); return; }
      const newName = base + pendingRenameExt;
      const nameCell = pendingRenameRow.children[0]; nameCell.textContent = newName;
      const dl = pendingRenameRow.querySelector("a.pill.neutral[download]"); if (dl) dl.download = newName;
      renameErr.classList.remove("show"); closeModal(renameModal); pendingRenameRow=null;
    }
    renameSave.addEventListener("click", applyRename);
    renameInput.addEventListener("keydown",(e)=>{ if (e.key==="Enter") applyRename(); });
  </script>
</body>
</html>