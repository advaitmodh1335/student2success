<!-- AI disclosure 
 Some Part of this code were generated by Chat GPT -->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Student · Profile</title>
  <link rel="stylesheet" href="../assets/css/base.css">
  <link rel="stylesheet" href="../assets/css/layout.css">
  <link rel="stylesheet" href="../assets/css/components.css">
  <style>
    /* Top bar (brand + logout) */
    .topbar{
      width:100%;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:16px 24px;
      border-bottom:1px solid var(--line)
    }
    .brand{font-weight:700;text-decoration:none;color:var(--ink)}
    .brand:hover{text-decoration:underline}
    .logout{color:var(--ink);text-decoration:none;border:1px solid var(--line);padding:6px 10px;border-radius:10px}
    .logout:hover{background:#fff}

    /* FULL-WIDTH back strip (left aligned to page) */
    .back-strip{
      width:100%;
      padding:16px 24px 0;
      display:flex;
      justify-content:flex-start;
    }
    .backbtn{
      display:inline-flex;align-items:center;gap:8px;
      background:#fff;color:var(--ink);
      border:1px solid var(--line);
      border-radius:10px;
      padding:.45rem .8rem;
      text-decoration:none;cursor:pointer;
    }
    .backbtn:hover{background:#f6f8fc;border-color:#c8d2e6}
    .backbtn svg{width:18px;height:18px;stroke:currentColor}

    /* Centered page title (container width) */
    .page-header{max-width:1100px;margin:0 auto;padding:12px 24px 24px}
    .page-header h1{margin:0;text-align:center}

    /* Center the save button under the form cards */
    .actions-row{
      max-width:1100px;
      margin:0 auto;
      padding:0 24px 24px;
      display:flex;
      justify-content:center; /* centered */
      gap:10px;
    }

    .btn{display:inline-block;padding:.65rem 1.05rem;border-radius:10px;border:0}
    .btn.safe{background:var(--accent);color:#fff}
    .btn.safe:hover{filter:brightness(.96)}

    /* Small success toast */
    .toast{
      position:fixed;right:24px;bottom:24px;
      background:#0f7a57;color:#fff;padding:.6rem .9rem;border-radius:10px;
      box-shadow:0 12px 30px rgba(0,0,0,.15);
      opacity:0;transform:translateY(10px);
      transition:opacity .18s ease, transform .18s ease;
      pointer-events:none;
    }
    .toast.show{opacity:1;transform:translateY(0)}

    /* --- Error modal (popup on window) --- */
    .backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(17,24,39,.45);z-index:300}
    .backdrop.show{display:flex}
    .modal{width:min(520px,94vw);background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 24px 60px rgba(2,8,23,.28)}
    .modal header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--line)}
    .modal .body{padding:16px}
    .modal .footer{padding:14px 16px;border-top:1px solid var(--line);display:flex;gap:10px;justify-content:flex-end}
    .modal .close-x{background:transparent;border:0;font-size:1.4rem;color:var(--muted);cursor:pointer;line-height:1}
  </style>
</head>

<body>
  <!-- Top bar -->
  <div class="topbar">
    <a class="brand" href="../index.html">Student2Success</a>
    <a href="../index.html" class="logout">Logout</a>
  </div>

  <!-- Back button (left side of page) -->
  <div class="back-strip">
    <button class="backbtn" type="button"
      onclick="history.length>1 ? history.back() : (window.location.href='dashboard.html')">
      <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <span>Back</span>
    </button>
  </div>

  <!-- Centered title -->
  <header class="page-header">
    <h1>Profile</h1>
  </header>

  <main class="container grid cols-2">
    <section class="card">
      <h3>Personal</h3>
      <label class="label" for="name">Full Name</label>
      <input id="name" class="input" placeholder="Your name">
      <label class="label" for="email">Email</label>
      <input id="email" class="input" placeholder="you@example.com">
    </section>

    <section class="card">
      <h3>Academic</h3>
      <label class="label" for="program">Program</label>
      <input id="program" class="input" placeholder="BSc Computer Science">
      <label class="label" for="grad">Expected Graduation</label>
      <input id="grad" class="input" placeholder="2027">
    </section>
  </main>

  <!-- Actions -->
  <div class="actions-row">
    <button id="saveProfile" class="btn safe">Save changes</button>
  </div>

  <footer class="footer">Student2Success</footer>

  <!-- Success toast -->
  <div id="saveToast" class="toast" role="status" aria-live="polite">Profile saved</div>

  <!-- Error popup -->
  <div id="errorModal" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="errorTitle">
    <div class="modal" role="document">
      <header>
        <h2 id="errorTitle">Missing information</h2>
        <button class="close-x" type="button" aria-label="Close" data-close>×</button>
      </header>
      <div class="body">
        <p>Please fill out all fields before saving.</p>
      </div>
      <!-- footer intentionally removed: only the cross button closes the modal -->
    </div>
  </div>

  <script>
    const elName = document.getElementById('name');
    const elEmail = document.getElementById('email');
    const elProgram = document.getElementById('program');
    const elGrad = document.getElementById('grad');
    const saveBtn = document.getElementById('saveProfile');

    const errorModal = document.getElementById('errorModal');
    let lastFocus = null;

    function openModal(el){
      lastFocus = document.activeElement;
      el.classList.add('show');
      const first = el.querySelector('button,[href],input,[tabindex]:not([tabindex="-1"])');
      if (first) first.focus();
    }
    function closeModal(el){
      el.classList.remove('show');
      try{ lastFocus && lastFocus.focus(); }catch(_){}
    }
    errorModal.addEventListener('click',(e)=>{
      if (e.target === errorModal || e.target.hasAttribute('data-close')) closeModal(errorModal);
    });
    window.addEventListener('keydown',(e)=>{
      if (e.key === 'Escape' && errorModal.classList.contains('show')) closeModal(errorModal);
    });

    function allFilled(){
      return [elName, elEmail, elProgram, elGrad].every(i => i.value.trim() !== '');
    }

    // Save only if all inputs are filled; otherwise show popup
    saveBtn.addEventListener('click', () => {
      if (!allFilled()) {
        openModal(errorModal);
        return;
      }

      const data = {
        name: elName.value.trim(),
        email: elEmail.value.trim(),
        program: elProgram.value.trim(),
        grad: elGrad.value.trim()
      };
      console.log('Saving profile…', data);

      try { localStorage.setItem('student_profile', JSON.stringify(data)); } catch(e) {}

      const toast = document.getElementById('saveToast');
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 1500);
    });

    // Pre-fill from localStorage for quick testing
    (function hydrate(){
      try {
        const saved = JSON.parse(localStorage.getItem('student_profile')||'{}');
        if(saved.name)   elName.value = saved.name;
        if(saved.email)  elEmail.value = saved.email;
        if(saved.program)elProgram.value = saved.program;
        if(saved.grad)   elGrad.value = saved.grad;
      } catch(e) {}
    })();
  </script>
</body>
</html>