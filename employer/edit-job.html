<!-- AI disclosure 
  Some Part of this code were generated by Chat GPT -->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Employer · Loading…</title>
  <link rel="stylesheet" href="../assets/css/base.css">
  <style>
    html,body{height:100%}
    body{min-height:100vh;display:flex;flex-direction:column}
    main{flex:1}

    /* ===== Topbar (matches candidate pages) ===== */
    .topbar{
      width:100%;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:16px 24px;
      border-bottom:1px solid var(--line)
    }
    .brand{font-weight:700;text-decoration:none;color:var(--ink)}
    .brand:hover{text-decoration:underline}
    .logout{color:var(--ink);text-decoration:none;border:1px solid var(--line);padding:6px 10px;border-radius:10px}
    .logout:hover{background:#fff}

    /* ===== Back strip (matches candidate pages) ===== */
    .back-strip{
      width:100%;
      padding:16px 24px 0;
      display:flex; justify-content:flex-start;
    }
    .backbtn{
      display:inline-flex;align-items:center;gap:8px;
      background:#fff;color:var(--ink);
      border:1px solid var(--line);
      border-radius:10px;
      padding:.45rem .8rem; cursor:pointer;
      text-decoration:none;
    }
    .backbtn:hover{background:#f6f8fc;border-color:#c8d2e6}
    .backbtn svg{width:18px;height:18px;stroke:currentColor}

    /* ===== Page header ===== */
    .page-header{max-width:1100px;margin:0 auto;padding:12px 24px 24px}
    .page-header h1{margin:0;text-align:center}
    .meta.center{text-align:center;color:var(--muted)}

    /* ===== Layout / form ===== */
    .stack{max-width:820px;margin:0 auto;padding:24px}
    .stack .card{margin:0}
    .actions-row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .btn.secondary{background:#fff;border:1px solid #d7deea;color:#0f1626}
    .btn.secondary:hover{background:#f6f8fc;border-color:#c8d2e6}

    /* ===== Job Type segmented control ===== */
    .seg{display:flex;gap:8px;flex-wrap:wrap}
    .seg .opt{position:relative}
    .seg input{position:absolute;opacity:0;pointer-events:none;}
    .seg label{
      display:inline-flex;align-items:center;justify-content:center;
      padding:.45rem .9rem;border-radius:999px;border:1px solid #d7deea;
      background:#fff;color:#0f1626;cursor:pointer;user-select:none;white-space:nowrap;
      transition:background .15s ease,border-color .15s ease,color .15s ease,box-shadow .15s ease;
    }
    .seg label:hover{background:#f6f8fc;border-color:#c8d2e6}
    .seg input:focus + label{outline:2px solid transparent;box-shadow:0 0 0 3px rgba(59,107,231,.28)}
    .seg input:checked + label{background:#eaf1ff;border-color:#c6d8ff;color:#23407a}

    /* Save/Cancel sizes */
    .actions-row .btn{
      display:inline-flex;align-items:center;justify-content:center;
      height:42px;
      padding:0 18px;
      min-width:200px;
      box-sizing:border-box;
    }
    @media (max-width:520px){
      .actions-row .btn{min-width:150px}
    }

    /* ===== Modal styles ===== */
    .backdrop{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(17,24,39,.45);z-index:300}
    .backdrop.show{display:flex}
    .modal{width:min(560px,94vw);background:#fff;border:1px solid var(--line);border-radius:14px;box-shadow:0 24px 60px rgba(2,8,23,.28)}
    .modal header{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;border-bottom:1px solid var(--line)}
    .modal .body{padding:16px}
    .modal .footer{padding:14px 16px;border-top:1px solid var(--line);display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap}
    .modal .close-x{background:transparent;border:0;font-size:1.4rem;color:var(--muted);cursor:pointer;line-height:1}
    .row{display:flex;align-items:center;gap:10px}
    .check{width:44px;height:44px;border-radius:999px;background:rgba(34,197,94,.12);border:1px solid #bfe6cf;color:#16a34a;display:grid;place-items:center;font-weight:700}
    .meta{color:var(--muted)}
  </style>
</head>
<body>
  <!-- Top bar -->
  <div class="topbar">
    <a class="brand" href="../index.html">Student2Success</a>
    <a href="../index.html" class="logout">Logout</a>
  </div>

  <!-- Back button (dynamic) -->
  <div class="back-strip">
    <button id="backBtn" class="backbtn" type="button">
      <svg viewBox="0 0 24 24" fill="none"><path d="M15 6l-6 6 6 6" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/></svg>
      <span id="backLabel">Jobs</span>
    </button>
  </div>

  <!-- Centered header -->
  <header class="page-header">
    <h1 id="pageTitle">Loading…</h1>
    <p class="meta center" id="jobMeta"></p>
  </header>

  <main>
    <div class="stack">
      <div class="card">
        <form id="editJob">
          <div class="field">
            <label class="label" for="title">Job Title</label>
            <input id="title" class="input" placeholder="Job title">
          </div>

          <div class="field">
            <label class="label" for="location">Location</label>
            <input id="location" class="input" placeholder="e.g., Calgary or Remote">
          </div>

          <div class="field">
            <label class="label" for="comp">Compensation</label>
            <input id="comp" class="input" placeholder="$ /hr">
          </div>

          <!-- Job Type -->
          <div class="field">
            <span class="label">Job Type</span>
            <div class="seg" role="radiogroup" aria-label="Job Type">
              <div class="opt">
                <input type="radio" id="jt-full"   name="jtype" value="Full-time">
                <label for="jt-full">Full-time</label>
              </div>
              <div class="opt">
                <input type="radio" id="jt-part"   name="jtype" value="Part-time">
                <label for="jt-part">Part-time</label>
              </div>
              <div class="opt">
                <input type="radio" id="jt-intern" name="jtype" value="Internship">
                <label for="jt-intern">Internship</label>
              </div>
              <div class="opt">
                <input type="radio" id="jt-coop"   name="jtype" value="Co-op">
                <label for="jt-coop">Co-op</label>
              </div>
            </div>
          </div>

          <div class="field">
            <label class="label" for="desc">Description</label>
            <textarea id="desc" class="input" rows="5" placeholder="Role summary, responsibilities..."></textarea>
          </div>

          <div class="field">
            <label class="label" for="req">Requirements</label>
            <textarea id="req" class="input" rows="4" placeholder="Skills, experience..."></textarea>
          </div>

          <div class="field">
            <label class="label" for="deadline">Deadline</label>
            <input id="deadline" class="input" placeholder="YYYY-MM-DD">
          </div>

          <div class="actions-row">
            <button class="btn" type="submit">Save Changes</button>
            <a id="cancelLink" class="btn secondary" href="jobs.html">Cancel</a>
          </div>
        </form>
      </div>
    </div>
  </main>

  <footer class="footer">Student2Success</footer>

  <!-- Save confirmation modal -->
  <div id="saveModal" class="backdrop" role="dialog" aria-modal="true" aria-labelledby="saveTitle">
    <div class="modal" role="document">
      <header>
        <h2 id="saveTitle">Changes saved</h2>
        <button class="close-x" type="button" aria-label="Close" data-close>×</button>
      </header>
      <div class="body">
        <div class="row">
          <div class="check">✓</div>
          <div>
            <div><strong id="mJobTitle">Job</strong> has been updated.</div>
            <div class="meta" id="mJobMeta">Type • Location • Compensation • Deadline</div>
          </div>
        </div>
      </div>
      <div class="footer">
        <button class="btn" type="button" data-close>Done</button>
      </div>
    </div>
  </div>

  <script>
    // --- Prototype dataset ---
    const JOBS = {
      'swe-intern': {
        title: 'Software Developer Intern',
        company: 'Tech Corp',
        location: 'Remote',
        comp: '$25/hr',
        type: 'Internship',
        desc: 'Collaborate with a small team to build internal tooling.',
        req: 'Basic HTML/CSS/JS\nGit fundamentals',
        deadline: '2026-01-01'
      },
      'web-engineer-coop': {
        title: 'Web Engineer Co-op',
        company: 'SiteWorks',
        location: 'Remote',
        comp: '$27/hr',
        type: 'Co-op',
        desc: 'Help ship front-end features with modern tooling.',
        req: 'React/TypeScript basics\nCI familiarity',
        deadline: '2026-02-15'
      }
    };

    const params = new URLSearchParams(location.search);
    const id = params.get('id') || 'swe-intern';
    const job = JOBS[id] || JOBS['swe-intern'];

    // ------ Dynamic header/title ------
    document.title = `Employer · Edit – ${job.title}`;
    const pageTitle = document.getElementById('pageTitle');
    pageTitle.textContent = `${job.title}`;
    const metaEl = document.getElementById('jobMeta');
    metaEl.textContent = `${job.company} · ${job.location} · ${job.comp}`;

    // ------ Populate form ------
    document.getElementById('title').value = job.title;
    document.getElementById('location').value = job.location;
    document.getElementById('comp').value = job.comp;
    document.getElementById('desc').value = job.desc;
    document.getElementById('req').value = job.req;
    document.getElementById('deadline').value = job.deadline;

    // Preselect Job Type (defaults to Full-time if missing)
    const typeValue = job.type || 'Full-time';
    const typeInput = document.querySelector(`input[name="jtype"][value="${typeValue}"]`);
    if (typeInput) typeInput.checked = true;
    else document.getElementById('jt-full').checked = true;

    // ------ Back button + Cancel destination (dynamic) ------
    const backBtn   = document.getElementById('backBtn');
    const backLabel = document.getElementById('backLabel');
    const cancelA   = document.getElementById('cancelLink');

    const ref = document.referrer || '';
    const fromParam = params.get('from');

    function resolveBack() {
      if (fromParam === 'dashboard' || /\/employer-dashboard\.html/i.test(ref)) {
        return { href: 'employer-dashboard.html', label: 'Dashboard' };
      }
      if (fromParam === 'jobs' || /\/jobs\.html/i.test(ref)) {
        return { href: 'jobs.html', label: 'Jobs' };
      }
      // Fallback
      return { href: 'jobs.html', label: 'Jobs' };
    }

    const back = resolveBack();
    backLabel.textContent = back.label;
    backBtn.onclick = () => { window.location.href = back.href; };
    cancelA.href = back.href;

    // ===== Modal helpers =====
    const saveModal = document.getElementById('saveModal');
    const mJobTitle = document.getElementById('mJobTitle');
    const mJobMeta  = document.getElementById('mJobMeta');
    let lastFocus = null;

    function openModal(el){
      lastFocus = document.activeElement;
      el.classList.add('show');
      const first = el.querySelector('button,[href],input,[tabindex]:not([tabindex="-1"])');
      if (first) first.focus();
    }
    function closeModal(el){
      el.classList.remove('show');
      try{ lastFocus && lastFocus.focus(); }catch(_){}
    }
    saveModal.addEventListener('click',(e)=>{
      if (e.target === saveModal || e.target.hasAttribute('data-close')) closeModal(saveModal);
    });
    window.addEventListener('keydown', (e)=>{
      if (e.key === 'Escape' && saveModal.classList.contains('show')) closeModal(saveModal);
    });

    // Handle form submit -> show confirmation modal (no navigation)
    document.getElementById('editJob').addEventListener('submit', (e)=>{
      e.preventDefault();

      // Collect current values (simulating save)
      const title = document.getElementById('title').value.trim() || 'Untitled job';
      const loc   = document.getElementById('location').value.trim() || '—';
      const comp  = document.getElementById('comp').value.trim() || '—';
      const desc  = document.getElementById('desc').value.trim();
      const req   = document.getElementById('req').value.trim();
      const dl    = document.getElementById('deadline').value.trim() || '—';
      const chosenType = (document.querySelector('input[name="jtype"]:checked') || {}).value || 'Full-time';

      // Fill the modal summary
      mJobTitle.textContent = title;
      mJobMeta.textContent  = `${chosenType} • ${loc} • ${comp} • ${dl}`;

      // Update our in-page dataset (prototype feel)
      Object.assign(job, { title, location: loc, comp, type: chosenType, desc, req, deadline: dl });

      // Update header titles live
      document.title = `Employer · Edit – ${title}`;
      pageTitle.textContent = `Edit · ${title}`;
      metaEl.textContent = `${job.company} · ${loc} · ${comp}`;

      // Open modal
      openModal(saveModal);
    });
  </script>
</body>
</html>